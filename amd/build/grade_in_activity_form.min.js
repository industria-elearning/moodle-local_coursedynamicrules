define("local_coursedynamicrules/grade_in_activity_form",["exports","core_form/dynamicform","core/notification","core/pending"],(function(_exports,_dynamicform,_notification,_pending){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * TODO describe module grade_in_activity_form
   *
   * @module     local_coursedynamicrules/grade_in_activity_form
   * @copyright  2024 Industria Elearning <info@industriaelearning.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */function attachCourseModuleChangeListener(dynamicForm){const courseModuleSelect=document.querySelector("[name=coursemodule]");courseModuleSelect?courseModuleSelect.addEventListener("change",(e=>{!function(dynamicForm,courseModuleValue){const updatePromise=new _pending.default("local_coursedynamicrules/grade_in_activity_form:update"),courseId=document.querySelector("[name=courseid]").value;dynamicForm.load({coursemodule:courseModuleValue,courseid:courseId}).then((()=>{attachCourseModuleChangeListener(dynamicForm),document.querySelector("[name=cmid]").value=courseModuleValue,document.querySelector("[name=gradeitems]").value=JSON.stringify({});const cmId=document.querySelector("[name=coursemodule]").value;return document.querySelectorAll("[data-cmid='".concat(cmId,"']")).forEach((input=>{const gradeItems=document.querySelector("[name=gradeitems]").value,gradeItemsObject=JSON.parse(gradeItems),condition=input.dataset.condition,gradeItem=input.dataset.gradeitem,value=input.value;gradeItemsObject["".concat(condition,"_").concat(gradeItem)]={gradeitem:gradeItem,condition:condition,value:value},document.querySelector("[name=gradeitems]").value=JSON.stringify(gradeItemsObject),input.addEventListener("change",(e=>{const gradeItems=document.querySelector("[name=gradeitems]").value,gradeItemsObject=JSON.parse(gradeItems),condition=e.target.dataset.condition,gradeItem=e.target.dataset.gradeitem,value=e.target.value;gradeItemsObject["".concat(condition,"_").concat(gradeItem)]={gradeitem:gradeItem,condition:condition,value:value},document.querySelector("[name=gradeitems]").value=JSON.stringify(gradeItemsObject)}))})),updatePromise.resolve()})).catch(_notification.default.exception)}(dynamicForm,e.target.value)})):_notification.default.addNotification({message:"Course module select element not found.",type:"warning"})}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=function(){const formContainer=document.querySelector("[data-region=dynamicform]");!function(dynamicForm){const loadPromise=new _pending.default(" local_coursedynamicrules/grade_in_activity_form:load"),courseId=document.querySelector("[name=courseid]").value;dynamicForm.load({courseid:courseId}).then((()=>{attachCourseModuleChangeListener(dynamicForm),document.querySelector("[name=gradeitems]").value=JSON.stringify({});const cmId=document.querySelector("[name=coursemodule]").value;document.querySelector("[name=cmid]").value=cmId;return document.querySelectorAll("[data-cmid='".concat(cmId,"']")).forEach((input=>{const gradeItems=document.querySelector("[name=gradeitems]").value,gradeItemsObject=JSON.parse(gradeItems),condition=input.dataset.condition,gradeItem=input.dataset.gradeitem,value=input.value;gradeItemsObject["".concat(condition,"_").concat(gradeItem)]={gradeitem:gradeItem,condition:condition,value:value},document.querySelector("[name=gradeitems]").value=JSON.stringify(gradeItemsObject),input.addEventListener("change",(e=>{const gradeItems=document.querySelector("[name=gradeitems]").value,gradeItemsObject=JSON.parse(gradeItems),condition=e.target.dataset.condition,gradeItem=e.target.dataset.gradeitem,value=e.target.value;gradeItemsObject["".concat(condition,"_").concat(gradeItem)]={gradeitem:gradeItem,condition:condition,value:value},document.querySelector("[name=gradeitems]").value=JSON.stringify(gradeItemsObject)}))})),loadPromise.resolve()})).catch(_notification.default.exception)}((container=formContainer,new _dynamicform.default(container,"local_coursedynamicrules\\form\\conditions\\dynamic_grade_in_activity_form")));var container},_dynamicform=_interopRequireDefault(_dynamicform),_notification=_interopRequireDefault(_notification),_pending=_interopRequireDefault(_pending)}));

//# sourceMappingURL=grade_in_activity_form.min.js.map